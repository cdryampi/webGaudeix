{% load static %}
{% if header %}
<div class="container-fluid p-0 header-container">
    {% include 'topbar/topbar.html' %}
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark menu-fijo" id="navbar" style="background-color: {{ header.color_fondo_header }} !important;">
        <div class="container">
            <div>
                {% if evento_especial_activo.logo_especial %}
                    <a class="navbar-brand" href="{% url 'eventos_especiales:evento_especial' slug=evento_especial_activo.slug %}">
                        <img src="{{ evento_especial_activo.logo_especial.url }}" alt="Logo" class="logo-img">
                    </a>
                 {% endif %}
                <a class="navbar-brand" href="{% url 'core:home' %}">
                    {% if header.logo %}
                        <img src="{{ header.logo.url }}" alt="Logo" class="logo-img">
                    {% else %}
                        <span class="logo-text">Cabrera de Mar</span>
                    {% endif %}
                </a>
            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" style="background-color: {{ header.color_fondo_header }} !important;" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    {% for referencia in referencias %}
                        {% if referencia.tipo == 'externo' %}
                            <li class="nav-item">
                                <a class="nav-link text-white font-weight-bold" href="{{ referencia.externo.enlace }}" target="_blank" style="color: {{ header.color_letra}} !important;">{{ referencia.externo.titulo }}</a>
                            </li>
                        {% elif referencia.tipo == 'post' %}
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle text-white font-weight-bold" href="{% url 'blog:detalle_post' slug=referencia.post.slug %}" style="color: {{ header.color_letra}} !important;">{{ referencia.post.titulo }}</a>
                            </li>
                        {% elif referencia.tipo == 'categoria' %}
                                {% if referencia.categoria.subcategorias.all %}
                                    <li class="nav-item dropdown">
                                        <a class="nav-link dropdown-toggle text-white font-weight-bold" href="javascript:void(0)" id="navbarDropdownCategoriaouter{{ referencia.categoria.id }}" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            {{ referencia.categoria.titulo }}
                                        </a>
                                        <ul class="dropdown-menu" aria-labelledby="navbarDropdownCategoriaouter{{ referencia.categoria.id }}">
                                            {% for subcat in referencia.categoria.subcategorias.all %}
                                                {% if subcat.publicado %}
                                                    <li class="nav-item">
                                                        <a class="dropdown-item" href="{% url 'blog:subcategoria' slug=subcat.slug %}">{{ subcat.titulo }}</a>
                                                    </li>
                                                {% endif %}
                                            {% endfor %}
                                            <li class="nav-item">
                                                <a class="dropdown-item" href="{% url 'blog:categoria' slug=referencia.categoria.slug %}">Saber més</a>
                                            </li>
                                        </ul>
                                    </li>
                                {% else %}
                                    <li class="nav-item">
                                        <a class="nav-link text-white font-weight-bold" href="{% url 'blog:categoria' slug=referencia.categoria.slug %}" style="color: {{ header.color_letra}} !important;">{{ referencia.categoria.titulo }}</a>
                                    </li>
                        {% endif %}
                        {% elif referencia.tipo == 'subblog' %}
                            {% if referencia.subblog.publicado %}
                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle text-white font-weight-bold" href="javascript:void(0)" id="navbarDropdownSubblog{{ referencia.subblog.id }}" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        {{ referencia.subblog.titulo }}
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="navbarDropdownSubblog{{ referencia.subblog.id }}">
                                        {% for categoria in categorias_header %}
                                            {% if categoria.subblog == referencia.subblog %}
                                                {% if categoria.subcategorias.all %}
                                                    <li class="dropdown-submenu">
                                                        <a class="dropdown-toggle" href="javascript:void(0)" id="navbarDropdownCategoriaInner{{ categoria.id }}" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                            {{ categoria.titulo }}
                                                        </a>
                                                        <ul class="dropdown-menu" aria-labelledby="navbarDropdownCategoriaInner{{ categoria.id }}">
                                                            {% for subcat in categoria.subcategorias.all %}
                                                                {% if subcat.publicado %}
                                                                    <li class="nav-item">
                                                                        <a class="dropdown-item" href="{% url 'blog:subcategoria' slug=subcat.slug %}">{{ subcat.titulo }}</a>
                                                                    </li>
                                                                {% endif %}
                                                            {% endfor %}
                                                            <li class="nav-item">
                                                                <a class="dropdown-item" href="{% url 'blog:categoria' slug=categoria.slug %}">Saber més</a>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                {% else %}
                                                    <li class="nav-item">
                                                        <a class="dropdown-item" href="{% url 'blog:categoria' slug=categoria.slug %}">{{ categoria.titulo }}</a>
                                                    </li>
                                                {% endif %}
                                            {% endif %}
                                        {% endfor %}
                                        <li class="nav-item">
                                            <a class="dropdown-item" href="{% url 'blog:detalle-subblog' slug=referencia.subblog.slug %}">Saber més</a>
                                        </li>
                                    </ul>
                                </li>
                            {% endif %}
                        {% elif referencia.tipo == 'contacto' %}
                            <li class="nav-item">
                                <a class="nav-link text-white font-weight-bold" href="{% url 'paginas_estaticas:contacto' %}" style="color: {{ header.color_letra}} !important;">{{ referencia.contacto.titulo }}</a>
                            </li>
                        {% elif referencia.tipo == 'evento_especial' %}
                            {% if referencia.evento_especial.publicado %}
                                <li class="nav-item active bg-white rounded-bottom shadow mx-0 mx-md-0 mx-sm-0 mx-lg-2 mx-xl-3 my-2 my-md-2 my-sm-2 my-lg-0 my-xl-0">
                                    <a class="nav-link text-black font-weight-bold evento_especial_link" href="{% url 'eventos_especiales:evento_especial' slug=referencia.evento_especial.slug %}" style="color: {{ header.color_fondo_header}} !important;">
                                        {{ referencia.evento_especial.titulo }}
                                    </a>
                                </li>
                            {% endif %}

                        {% elif referencia.tipo == 'punt_informacio' %}
                            <li class="nav-item">
                                <a class="nav-link text-white font-weight-bold" href="{% url 'paginas_estaticas:punt' %}" style="color: {{ header.color_letra}} !important;">{{ referencia.punt_informacio.titulo }}</a>
                            </li>
                        
                        {% elif referencia.tipo == 'compra_y_descubre' %}
                            <li class="nav-item">
                                <a class="nav-link text-white font-weight-bold" href="{% url 'compra_y_descubre:compra_y_descubre' slug=referencia.compra_y_descubre.slug %}" style="color: {{ header.color_letra}} !important;">{{ referencia.compra_y_descubre.titulo }}</a>
                            </li>
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
        </div>
    </nav>
</div>
{% else %}
    {% include 'header/header_default.html' %}
{% endif %}
