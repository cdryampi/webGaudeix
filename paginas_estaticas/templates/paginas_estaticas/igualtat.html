{% extends 'core/base.html' %}
{% load static %}
{% block meta_description %}
    {% if diversidad.metadescripcion %}
        <meta name="description" content="{{diversidad.metadescripcion |safe | striptags}}">
        <meta property="og:description" content="{{ diversidad.metadescripcion |safe | striptags }}">
    {% else %}
        {% if diversidad.descripcion_auxiliar %}
            <meta name="Description" content="{{ diversidad.descripcion_auxiliar | safe | striptags | truncatewords_html:150 }}">
            <meta property="og:description" content="{{ diversidad.descripcion_auxiliar | striptags | truncatewords_html:150 | safe }}">
        {% endif %}
    {% endif %}
{% endblock meta_description %}

{% block meta_keywords %}
    <meta name="keywords" content="dones, igualtat, diversitat, Cabrera de Mar, inclusió, LGTBIQ+">
{% endblock meta_keywords %}

{% block title %}
    {% autoescape off %}
        {{ diversidad.metatitulo | safe  }}
    {% endautoescape %}
{% endblock title %}
{% block extra_css %}
<style>
    .link-image {
        transition: transform 0.3s ease-in-out;
    }
    
    .link-image:hover {
        transform: scale(1.05);
    }
    /* Define un contenedor para el grid */
    .imgs-diversitat {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* Repite las columnas según sea necesario, con un mínimo de 200px y máximo de 1fr */
      gap: 20px; /* Espacio entre elementos */
      justify-items: center; /* Centrar horizontalmente */
      align-items: center; /* Centrar verticalmente */
    }
    
    /* Estilo para las imágenes */
    .image-container-diversidad-unique {
      text-align: center;
    }
    .img-diversidad {
        width: 100%;
        height: auto;
        max-width: none; /* Elimina cualquier límite máximo de ancho */
      }
    .img-diversidad-unique {
      max-width: 100%;
      height: auto;
      border: none;
      border-radius: 0;
    }
    
</style>
{% endblock extra_css %}



{% block content %}

<div class="container-fluid p-0 m-0">
    <div class="container pt-5">
        <h1 class="h1 text-uppercase text-center">{{ diversidad.titulo }}</h1>
        <p class="lead text-center pt-2 pt-sm-2 pt-md-3 pt-lg-3 pt-xl-3">{{ diversidad.sub_titulo }}</p>
    </div>
    {% if diversidad.logros.all %}
        <div class="container pt-5 bg-light">
            <div class="col-12 p-3">
                <h2 class="h3 mt-4 text-center"><strong>Llocs Físics de Protecció contra les Violències Masclistes</strong></h2>
            </div>
            <div class="row justify-content-center">
                {% for logro in diversidad.logros.all %}
                    <div class="col-12 p-3 {% if forloop.counter|divisibleby:2 %}bg-light{% endif %}">
                        <div class="col-12 p-3">
                            <h3 class="text-center h3 p-2">{{ logro.titulo }}</h3>
                        </div>
                        <div class="row justify-content-center">

                            {% if forloop.counter|divisibleby:2 %}
                                <div class="col-12 col-md-12 col-sm-6 col-lg-6 col-xl-6">
                                    {% if logro.postimagen %}
                                        {% with logro.postimagen as img %}
                                            <div class="image-container">
                                                <img class="img-fluid rounded border" src="{{ img.imagen.archivo.url }}" />
                                            </div>
                                        {% endwith %}
                                    {% endif %}
                                </div>
                                <div class="col-12 col-md-12 col-sm-6 col-lg-6 col-xl-6">
                                    {% autoescape on %}
                                        {{ logro.descripcion | safe | truncatechars:450  }}
                                    {% endautoescape %}
                                    
                                    <a href="{% url 'blog:detalle_post' logro.slug %}" class="btn btn-link btn-sm font-weight-bold">Saber més</a>
                                </div>
                            {% else %}
                                <div class="col-12 col-md-12 col-sm-6 col-lg-6 col-xl-6">
                                    {% autoescape on %}
                                        {{ logro.descripcion | safe | truncatechars:450  }}
                                        <a href="
                                        {% if logro.agenda %} 
                                            {% url 'agenda:detalle_agenda' slug=logro.slug %}
                                        {% elif logro.visitaguiada %}
                                            {% url 'agenda:visites-guiades' slug=logro.slug %}
                                        {% elif logro.mappoint %}
                                            {% url 'map:mapa' slug=logro.slug %}
                                        {% elif logro.ruta %}
                                            {% url 'agenda:ruta' slug=logro.slug %}
                                        {% else %}
                                            {{ logro.get_absolute_url }}
                                        {% endif %}
                                    
                                    " class="btn btn-link btn-sm font-weight-bold">Saber més</a>
                                    {% endautoescape %}
                                </div>
                                <div class="col-12 col-md-12 col-sm-6 col-lg-6 col-xl-6">
                                    {% if logro.postimagen %}
                                        {% with logro.postimagen as img %}
                                            <div class="image-container">
                                                <img class="img-fluid rounded border" src="{{ img.imagen.archivo.url }}" />
                                            </div>
                                        {% endwith %}
                                    {% endif %}
                                </div>
                            {% endif %}

                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}
    {% if diversidad.diversidadimagenbanner_set.all %}
        <div class="container-fluid py-3 bg-white">
            <div class="col-12 p-3">
                <h2 class="h2 mt-4 text-center"><strong>Col·laboració d'Entitats pel Pacte Integral</strong></h2>
            </div>
            <div class="container">
                <div class="row imgs-diversitat">
                    {% for banner in diversidad.diversidadimagenbanner_set.all %}
                            {% if banner.imagen %}
                                {% with banner.imagen as img %}
                                    <div class="image-container-diversidad-unique text-center">
                                        <a href="{{ banner.enlace }}" target="_blank" title="{{ banner.nombre }}" class="link-image">
                                            <img class="img-diversidad-unique rounded-0" src="{{ img.archivo.url }}"/>
                                        </a>
                                    </div>                        
                                {% endwith %}
                            {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    {% endif %}


    {% if diversidad.planes.all %}
        <div class="container pt-5 bg-light">
            <div class="col-12 p-3">
                <h2 class="h2 text-center"><strong>Plans i Activitats per a la Igualtat</strong></h2>

            </div>
            <div class="row justify-content-center">
                {% for plan in diversidad.planes.all %}
                <div class="col-12 col-md-12 col-sm-4 col-lg-4 col-xl-4 p-3">
                    <div class="col-12 p-3">
                        <h3 class="text-center h3 p-2">{{ plan.titulo }}</h3>
                    </div>
                    <div class="row justify-content-center m-0">
                            {% if plan.postimagen %}
                                {% with plan.postimagen as img %}
                                    <div class="image-container">
                                        <img class="img-fluid rounded-circle" src="{{ img.imagen.archivo.url }}" title = "{{ plan.titulo }}"/>
                                    </div>
                                {% endwith %}
                            {% endif %}
                            {% autoescape on %}
                                <div class="p-3">
                                    {{ plan.descripcion | safe | truncatechars:150 }}
                                </div>
                            {% endautoescape %}
                            <a href="
                            {% if plan.agenda %} 
                                {% url 'agenda:detalle_agenda' slug=plan.slug %}
                            {% elif plan.visitaguiada %}
                                {% url 'agenda:visites-guiades' slug=plan.slug %}
                            {% elif plan.mappoint %}
                                {% url 'map:mapa' slug=plan.slug %}
                            {% elif plan.ruta %}
                                {% url 'agenda:ruta' slug=plan.slug %}
                            {% else %}
                                {{ plan.get_absolute_url }}
                            {% endif %}
                        
                        " class="btn btn-link btn-sm font-weight-bold">Saber més</a>

                    </div>
                </div>
            {% endfor %}
            </div>
        </div>
    {% endif %}
    {% if diversidad.descripcion_auxiliar %}
        <div class="container p-1 p-sm-2 p-md-3 p-lg-4 p-xl-5">
            <div class="row justify-content-center m-0">
                <div class="p-3 text-center lead">
                    {% autoescape on %}
                        {{ diversidad.descripcion_auxiliar | safe }}
                    {% endautoescape %}
                </div>
            </div>
        </div>
    {% endif %}
    {% if diversidad.pdfdiversidadfichero_set.all %}
    <div class="container p-0 p-sm-2 p-md-3 p-lg-4 p-xl-5">
        <div class="row justify-content-center m-0">
            <h2 class="h2 text-center">Descàrrega de Recursos i Materials</h2>
        </div>
        <div class="row justify-content-center m-0">
            {% for fichero in diversidad.pdfdiversidadfichero_set.all %}
            <div class="col-12 col-md-6 col-lg-4 mb-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">{{ fichero.titulo }}</h5>
                        <a href="{{ fichero.fichero.archivo.url }}" target="_blank" class="btn btn-light btn-block">Veure arxiu</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    



</div>

{% endblock content %}